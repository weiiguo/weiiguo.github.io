<nav class="site-nav">
  <div class="nav-container">
    <div class="nav-logo">
      <a href="{{ '/' | relative_url }}">
        <img src="{{ '/assets/img/UST.png' | relative_url }}" alt="UST Logo" class="nav-logo-img">
      </a>
    </div>
    <div class="nav-toggle" id="navToggle">
      <span></span>
      <span></span>
      <span></span>
    </div>
    <ul class="nav-links" id="navLinks">
      {% for item in site.data.navigation.main %}
        <li class="nav-item">
          <a href="{{ item.url | relative_url }}" class="nav-link{% if page.url == item.url %} active{% endif %}">{{ item.name }}</a>
        </li>
      {% endfor %}
    </ul>
  </div>
</nav>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const navToggle = document.getElementById('navToggle');
    const navLinks = document.getElementById('navLinks');
    let isMenuOpen = false;
    
    // 打开菜单
    function openMenu() {
      navLinks.classList.add('show');
      navToggle.classList.add('active');
      navLinks.style.display = 'block';
      // 强制重排以确保高度计算正确
      void navLinks.offsetHeight;
      navLinks.style.opacity = '1';
      isMenuOpen = true;
    }
    
    // 关闭菜单
    function closeMenu() {
      navLinks.classList.remove('show');
      navToggle.classList.remove('active');
      navLinks.style.opacity = '0';
      isMenuOpen = false;
      
      // 等待过渡效果完成后隐藏菜单
      setTimeout(function() {
        if (!isMenuOpen) {
          navLinks.style.display = 'none';
        }
      }, 300);
    }
    
    // 切换菜单状态
    function toggleMenu() {
      if (isMenuOpen) {
        closeMenu();
      } else {
        openMenu();
      }
    }
    
    // 确保汉堡菜单按钮正常工作
    navToggle.addEventListener('click', function(e) {
      e.preventDefault();
      toggleMenu();
    });
    
    // 点击链接后关闭菜单
    const navItems = document.querySelectorAll('.nav-link');
    navItems.forEach(item => {
      item.addEventListener('click', function() {
        if (window.innerWidth <= 768) {
          closeMenu();
        }
      });
    });
    
    // 确保在窗口调整大小时重置菜单状态
    window.addEventListener('resize', function() {
      if (window.innerWidth > 768) {
        // 重置为桌面样式
        navLinks.classList.remove('show');
        navToggle.classList.remove('active');
        navLinks.style.display = '';
        navLinks.style.opacity = '';
        navLinks.style.height = '';
        isMenuOpen = false;
      }
    });
  });
</script> 